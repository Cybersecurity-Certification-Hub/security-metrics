package cch.metrics.number_of_known_critical_vulnerabilities

import data.cch.compare
import rego.v1
import input.vulnerabilities as vuls

default applicable := false
default compliant := false

applicable if {
  vuls
}

critical_vuln_count_str := s if {
  criticals := {v |
    v := vuls[_]
    v.criticality == "critical"
  }
  n := count(criticals)
  s := sprintf("%d", [n])
}

compliant if {
  	compare(data.operator, data.target_value, critical_vuln_count_str)
}

