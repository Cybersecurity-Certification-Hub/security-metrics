package cch.metrics.number_of_known_high_vulnerabilities

import data.cch.compare
import rego.v1
import input.vulnerabilities as vuls

default applicable := false
default compliant := false

applicable if {
  vuls
}

high_vuln_count_str := s if {
  highs := {v |
    v := vuls[_]
    v.criticality == "high"
  }
  n := count(highs)
  s := sprintf("%d", [n])
}

compliant if {
  	compare(data.operator, data.target_value, high_vuln_count_str)
}
