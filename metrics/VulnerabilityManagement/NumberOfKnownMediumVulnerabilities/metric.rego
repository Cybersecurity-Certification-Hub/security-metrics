package cch.metrics.number_of_known_medium_vulnerabilities

import data.cch.compare
import rego.v1
import input.vulnerabilities as vuls

default applicable := false
default compliant := false

applicable if {
  vuls
}

medium_vuln_count_str := s if {
  mediums := {v |
    v := vuls[_]
    v.criticality == "medium"
  }
  n := count(mediums)
  s := sprintf("%d", [n])
}

compliant if {
  	compare(data.operator, data.target_value, medium_vuln_count_str)
}
