package cch.metrics.number_of_known_low_vulnerabilities

import data.cch.compare
import rego.v1
import input.vulnerabilities as vuls

default applicable := false
default compliant := false

applicable if {
  vuls
}

low_vuln_count_str := s if {
  lows := {v |
    v := vuls[_]
    v.criticality == "low"
  }
  n := count(lows)
  s := sprintf("%d", [n])
}

compliant if {
  	compare(data.operator, data.target_value, low_vuln_count_str)
}
